<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.shape.Circle?>

<BorderPane xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.example.guser.controllers.ProfileController"
            stylesheets="@app.css">

    <top>
        <!-- If app_nav.fxml is in a subfolder, update source accordingly (e.g. components/app_nav.fxml). -->
        <fx:include fx:id="appNav" source="app_nav.fxml"/>
    </top>

    <center>
        <StackPane>
            <Pane styleClass="prf-bg" mouseTransparent="true"/>

            <ScrollPane fitToWidth="true" styleClass="prf-scroll">
                <content>
                    <VBox alignment="TOP_CENTER" styleClass="prf-page">
                        <padding><Insets top="18" right="18" bottom="24" left="18"/></padding>

                        <VBox spacing="14" styleClass="prf-container">

                            <!-- ================= HEADER ================= -->
                            <StackPane styleClass="prf-card prf-headerCard">
                                <VBox>
                                    <Pane prefHeight="150" styleClass="prf-cover"/>

                                    <VBox styleClass="prf-headerBody" spacing="10">
                                        <HBox spacing="14" alignment="CENTER_LEFT">
                                            <StackPane styleClass="prf-avatarWrap">
                                                <Circle radius="46" styleClass="prf-avatarRing"/>
                                                <Circle fx:id="avatarCircle" radius="42" fill="#d9d9d9"/>
                                            </StackPane>

                                            <VBox spacing="4" HBox.hgrow="ALWAYS">
                                                <Label fx:id="fullNameLabel" text="Full Name" styleClass="prf-h1"/>
                                                <Label fx:id="subTitleLabel" text="Headline / Orgname" styleClass="prf-subtitle"/>
                                                <Label fx:id="metaLabel" text="ROLE • Location • Website" styleClass="prf-meta"/>
                                            </VBox>

                                            <VBox spacing="8" alignment="TOP_RIGHT">
                                                <HBox spacing="8" alignment="CENTER_RIGHT">
                                                    <Button fx:id="headerEditBtn" text="Edit" onAction="#onHeaderEdit"
                                                            styleClass="prf-btn prf-btnSoft"/>

                                                    <Button fx:id="headerBackBtn" text="← Back" onAction="#onHeaderBack"
                                                            styleClass="prf-btn prf-btnSoft"
                                                            visible="false" managed="false"/>

                                                    <Button fx:id="headerSaveBtn" text="Save" onAction="#onHeaderSave"
                                                            styleClass="prf-btn prf-btnPrimary"
                                                            visible="false" managed="false"/>
                                                </HBox>

                                                <Button fx:id="changePicBtn" text="Change picture" onAction="#onChangePicture"
                                                        styleClass="prf-linkBtn" visible="false" managed="false"/>
                                            </VBox>
                                        </HBox>
                                    </VBox>
                                </VBox>
                            </StackPane>

                            <Label fx:id="errorLabel" text="" styleClass="prf-error" visible="false" managed="false"/>

                            <!-- ================= GRID ================= -->
                            <GridPane hgap="14" vgap="14">
                                <columnConstraints>
                                    <ColumnConstraints percentWidth="66"/>
                                    <ColumnConstraints percentWidth="34"/>
                                </columnConstraints>

                                <!-- LEFT -->
                                <VBox spacing="14" GridPane.columnIndex="0">

                                    <!-- ================= BASIC ================= -->
                                    <VBox styleClass="prf-card" spacing="10">
                                        <HBox alignment="CENTER_LEFT">
                                            <Label text="Basic info" styleClass="prf-cardTitle"/>
                                            <Region HBox.hgrow="ALWAYS"/>
                                            <Button fx:id="basicPencilBtn" text="✎" onAction="#onBasicEdit" styleClass="prf-iconBtn"/>

                                            <Button fx:id="basicBackBtn" text="← Back" onAction="#onBasicBack"
                                                    styleClass="prf-btn prf-btnSoft prf-miniBtn"
                                                    visible="false" managed="false"/>

                                            <Button fx:id="basicSaveBtn" text="Save" onAction="#onBasicSave"
                                                    styleClass="prf-btn prf-btnPrimary prf-miniBtn"
                                                    visible="false" managed="false"/>
                                        </HBox>

                                        <!-- view -->
                                        <VBox fx:id="basicViewBox" spacing="10">
                                            <GridPane hgap="10" vgap="10">
                                                <columnConstraints>
                                                    <ColumnConstraints percentWidth="50"/>
                                                    <ColumnConstraints percentWidth="50"/>
                                                </columnConstraints>

                                                <VBox spacing="4" GridPane.columnIndex="0" GridPane.rowIndex="0">
                                                    <Label text="First name" styleClass="prf-label"/>
                                                    <Label fx:id="firstNameView" styleClass="prf-value"/>
                                                </VBox>
                                                <VBox spacing="4" GridPane.columnIndex="1" GridPane.rowIndex="0">
                                                    <Label text="Last name" styleClass="prf-label"/>
                                                    <Label fx:id="lastNameView" styleClass="prf-value"/>
                                                </VBox>
                                                <VBox spacing="4" GridPane.columnIndex="0" GridPane.rowIndex="1">
                                                    <Label text="Location" styleClass="prf-label"/>
                                                    <Label fx:id="locationView" styleClass="prf-value"/>
                                                </VBox>
                                                <VBox spacing="4" GridPane.columnIndex="1" GridPane.rowIndex="1">
                                                    <Label text="Phone" styleClass="prf-label"/>
                                                    <Label fx:id="phoneView" styleClass="prf-value"/>
                                                </VBox>
                                            </GridPane>
                                        </VBox>

                                        <!-- edit -->
                                        <VBox fx:id="basicEditBox" spacing="10" visible="false" managed="false">
                                            <GridPane hgap="10" vgap="10">
                                                <columnConstraints>
                                                    <ColumnConstraints percentWidth="50"/>
                                                    <ColumnConstraints percentWidth="50"/>
                                                </columnConstraints>

                                                <VBox spacing="6" GridPane.columnIndex="0" GridPane.rowIndex="0">
                                                    <Label text="First name" styleClass="prf-label"/>
                                                    <TextField fx:id="firstNameField" styleClass="prf-editorField"/>
                                                </VBox>
                                                <VBox spacing="6" GridPane.columnIndex="1" GridPane.rowIndex="0">
                                                    <Label text="Last name" styleClass="prf-label"/>
                                                    <TextField fx:id="lastNameField" styleClass="prf-editorField"/>
                                                </VBox>
                                                <VBox spacing="6" GridPane.columnIndex="0" GridPane.rowIndex="1">
                                                    <Label text="Location" styleClass="prf-label"/>
                                                    <TextField fx:id="locationField" styleClass="prf-editorField"/>
                                                </VBox>
                                                <VBox spacing="6" GridPane.columnIndex="1" GridPane.rowIndex="1">
                                                    <Label text="Phone" styleClass="prf-label"/>
                                                    <TextField fx:id="phoneField" styleClass="prf-editorField"/>
                                                </VBox>
                                            </GridPane>
                                        </VBox>
                                    </VBox>

                                    <!-- ================= CANDIDATE SECTION ================= -->
                                    <VBox fx:id="candidateSection" spacing="14">

                                        <!-- ABOUT -->
                                        <VBox styleClass="prf-card" spacing="10">
                                            <HBox alignment="CENTER_LEFT">
                                                <Label text="About" styleClass="prf-cardTitle"/>
                                                <Region HBox.hgrow="ALWAYS"/>
                                                <Button fx:id="aboutPencilBtn" text="✎" onAction="#onAboutEdit" styleClass="prf-iconBtn"/>

                                                <Button fx:id="aboutBackBtn" text="← Back" onAction="#onAboutBack"
                                                        styleClass="prf-btn prf-btnSoft prf-miniBtn"
                                                        visible="false" managed="false"/>

                                                <Button fx:id="aboutSaveBtn" text="Save" onAction="#onAboutSave"
                                                        styleClass="prf-btn prf-btnPrimary prf-miniBtn"
                                                        visible="false" managed="false"/>
                                            </HBox>

                                            <VBox fx:id="aboutViewBox" spacing="10">
                                                <VBox spacing="4">
                                                    <Label text="Headline" styleClass="prf-label"/>
                                                    <Label fx:id="headlineView" styleClass="prf-value"/>
                                                </VBox>
                                                <VBox spacing="4">
                                                    <Label text="Bio" styleClass="prf-label"/>
                                                    <Label fx:id="bioView" styleClass="prf-paragraph" wrapText="true"/>
                                                </VBox>
                                            </VBox>

                                            <VBox fx:id="aboutEditBox" spacing="10" visible="false" managed="false">
                                                <VBox spacing="6">
                                                    <Label text="Headline" styleClass="prf-label"/>
                                                    <TextField fx:id="headlineField" styleClass="prf-editorField"/>
                                                </VBox>
                                                <VBox spacing="6">
                                                    <Label text="Bio" styleClass="prf-label"/>
                                                    <TextArea fx:id="bioArea" styleClass="prf-editorArea"
                                                              prefRowCount="4" wrapText="true"
                                                              promptText="Write a short bio..."/>
                                                </VBox>
                                            </VBox>
                                        </VBox>

                                        <!-- EDUCATION -->
                                        <VBox styleClass="prf-card" spacing="10">
                                            <HBox alignment="CENTER_LEFT">
                                                <Label text="Education" styleClass="prf-cardTitle"/>
                                                <Region HBox.hgrow="ALWAYS"/>
                                                <Button fx:id="eduPencilBtn" text="✎" onAction="#onEducationEdit" styleClass="prf-iconBtn"/>

                                                <Button fx:id="eduBackBtn" text="← Back" onAction="#onEducationBack"
                                                        styleClass="prf-btn prf-btnSoft prf-miniBtn"
                                                        visible="false" managed="false"/>

                                                <Button fx:id="eduSaveBtn" text="Save" onAction="#onEducationSave"
                                                        styleClass="prf-btn prf-btnPrimary prf-miniBtn"
                                                        visible="false" managed="false"/>
                                            </HBox>

                                            <VBox fx:id="eduViewBox" spacing="10">
                                                <GridPane hgap="10" vgap="10">
                                                    <columnConstraints>
                                                        <ColumnConstraints percentWidth="50"/>
                                                        <ColumnConstraints percentWidth="50"/>
                                                    </columnConstraints>

                                                    <VBox spacing="4" GridPane.columnIndex="0" GridPane.rowIndex="0">
                                                        <Label text="School" styleClass="prf-label"/>
                                                        <Label fx:id="schoolView" styleClass="prf-value"/>
                                                    </VBox>

                                                    <VBox spacing="4" GridPane.columnIndex="1" GridPane.rowIndex="0">
                                                        <Label text="Degree" styleClass="prf-label"/>
                                                        <Label fx:id="degreeView" styleClass="prf-value"/>
                                                    </VBox>

                                                    <VBox spacing="4" GridPane.columnIndex="0" GridPane.rowIndex="1">
                                                        <Label text="Field of study" styleClass="prf-label"/>
                                                        <Label fx:id="fieldView" styleClass="prf-value"/>
                                                    </VBox>

                                                    <VBox spacing="4" GridPane.columnIndex="1" GridPane.rowIndex="1">
                                                        <Label text="Graduation year" styleClass="prf-label"/>
                                                        <Label fx:id="gradYearView" styleClass="prf-value"/>
                                                    </VBox>
                                                </GridPane>
                                            </VBox>

                                            <VBox fx:id="eduEditBox" spacing="10" visible="false" managed="false">
                                                <GridPane hgap="10" vgap="10">
                                                    <columnConstraints>
                                                        <ColumnConstraints percentWidth="50"/>
                                                        <ColumnConstraints percentWidth="50"/>
                                                    </columnConstraints>

                                                    <VBox spacing="6" GridPane.columnIndex="0" GridPane.rowIndex="0">
                                                        <Label text="School" styleClass="prf-label"/>
                                                        <TextField fx:id="schoolField" styleClass="prf-editorField"/>
                                                    </VBox>

                                                    <VBox spacing="6" GridPane.columnIndex="1" GridPane.rowIndex="0">
                                                        <Label text="Degree" styleClass="prf-label"/>
                                                        <TextField fx:id="degreeField" styleClass="prf-editorField"/>
                                                    </VBox>

                                                    <VBox spacing="6" GridPane.columnIndex="0" GridPane.rowIndex="1">
                                                        <Label text="Field of study" styleClass="prf-label"/>
                                                        <TextField fx:id="fieldOfStudyField" styleClass="prf-editorField"/>
                                                    </VBox>

                                                    <VBox spacing="6" GridPane.columnIndex="1" GridPane.rowIndex="1">
                                                        <Label text="Graduation year" styleClass="prf-label"/>
                                                        <TextField fx:id="graduationYearField" styleClass="prf-editorField" promptText="2028"/>
                                                    </VBox>
                                                </GridPane>
                                            </VBox>
                                        </VBox>

                                        <!-- SKILLS -->
                                        <VBox styleClass="prf-card" spacing="10">
                                            <HBox alignment="CENTER_LEFT">
                                                <Label text="Skills" styleClass="prf-cardTitle"/>
                                                <Region HBox.hgrow="ALWAYS"/>
                                                <Button fx:id="skillsPencilBtn" text="✎" onAction="#onSkillsEdit" styleClass="prf-iconBtn"/>

                                                <Button fx:id="skillsBackBtn" text="← Back" onAction="#onSkillsBack"
                                                        styleClass="prf-btn prf-btnSoft prf-miniBtn"
                                                        visible="false" managed="false"/>

                                                <Button fx:id="skillsSaveBtn" text="Save" onAction="#onSkillsSave"
                                                        styleClass="prf-btn prf-btnPrimary prf-miniBtn"
                                                        visible="false" managed="false"/>
                                            </HBox>

                                            <VBox fx:id="skillsViewBox" spacing="10">
                                                <VBox spacing="6">
                                                    <Label text="Hard skills" styleClass="prf-label"/>
                                                    <FlowPane fx:id="hardSkillsPane" hgap="8" vgap="8"/>
                                                </VBox>
                                                <VBox spacing="6">
                                                    <Label text="Soft skills" styleClass="prf-label"/>
                                                    <FlowPane fx:id="softSkillsPane" hgap="8" vgap="8"/>
                                                </VBox>
                                            </VBox>

                                            <VBox fx:id="skillsEditBox" spacing="10" visible="false" managed="false">
                                                <VBox spacing="6">
                                                    <Label text="Hard skills (comma separated)" styleClass="prf-label"/>
                                                    <TextArea fx:id="hardSkillsArea" styleClass="prf-editorArea"
                                                              prefRowCount="2" wrapText="true"
                                                              promptText="Java, SQL, Docker"/>
                                                </VBox>
                                                <VBox spacing="6">
                                                    <Label text="Soft skills (comma separated)" styleClass="prf-label"/>
                                                    <TextArea fx:id="softSkillsArea" styleClass="prf-editorArea"
                                                              prefRowCount="2" wrapText="true"
                                                              promptText="Communication, Teamwork"/>
                                                </VBox>
                                            </VBox>
                                        </VBox>

                                        <!-- LINKS -->
                                        <VBox styleClass="prf-card" spacing="10">
                                            <HBox alignment="CENTER_LEFT">
                                                <Label text="Links" styleClass="prf-cardTitle"/>
                                                <Region HBox.hgrow="ALWAYS"/>
                                                <Button fx:id="linksPencilBtn" text="✎" onAction="#onLinksEdit" styleClass="prf-iconBtn"/>

                                                <Button fx:id="linksBackBtn" text="← Back" onAction="#onLinksBack"
                                                        styleClass="prf-btn prf-btnSoft prf-miniBtn"
                                                        visible="false" managed="false"/>

                                                <Button fx:id="linksSaveBtn" text="Save" onAction="#onLinksSave"
                                                        styleClass="prf-btn prf-btnPrimary prf-miniBtn"
                                                        visible="false" managed="false"/>
                                            </HBox>

                                            <VBox fx:id="linksViewBox" spacing="10">
                                                <GridPane hgap="10" vgap="10">
                                                    <columnConstraints>
                                                        <ColumnConstraints percentWidth="50"/>
                                                        <ColumnConstraints percentWidth="50"/>
                                                    </columnConstraints>

                                                    <VBox spacing="4" GridPane.columnIndex="0" GridPane.rowIndex="0">
                                                        <Label text="GitHub" styleClass="prf-label"/>
                                                        <Label fx:id="githubView" styleClass="prf-linkValue"/>
                                                    </VBox>

                                                    <VBox spacing="4" GridPane.columnIndex="1" GridPane.rowIndex="0">
                                                        <Label text="Portfolio" styleClass="prf-label"/>
                                                        <Label fx:id="portfolioView" styleClass="prf-linkValue"/>
                                                    </VBox>
                                                </GridPane>
                                            </VBox>

                                            <VBox fx:id="linksEditBox" spacing="10" visible="false" managed="false">
                                                <GridPane hgap="10" vgap="10">
                                                    <columnConstraints>
                                                        <ColumnConstraints percentWidth="50"/>
                                                        <ColumnConstraints percentWidth="50"/>
                                                    </columnConstraints>

                                                    <VBox spacing="6" GridPane.columnIndex="0" GridPane.rowIndex="0">
                                                        <Label text="GitHub" styleClass="prf-label"/>
                                                        <TextField fx:id="githubField" styleClass="prf-editorField" promptText="https://github.com/..."/>
                                                    </VBox>

                                                    <VBox spacing="6" GridPane.columnIndex="1" GridPane.rowIndex="0">
                                                        <Label text="Portfolio" styleClass="prf-label"/>
                                                        <TextField fx:id="portfolioField" styleClass="prf-editorField" promptText="https://..."/>
                                                    </VBox>
                                                </GridPane>
                                            </VBox>
                                        </VBox>

                                    </VBox>

                                    <!-- ================= RECRUITER SECTION ================= -->
                                    <VBox fx:id="recruiterSection" spacing="14" visible="false" managed="false">

                                        <VBox styleClass="prf-card" spacing="10">
                                            <HBox alignment="CENTER_LEFT">
                                                <Label text="Organization" styleClass="prf-cardTitle"/>
                                                <Region HBox.hgrow="ALWAYS"/>
                                                <Button fx:id="orgPencilBtn" text="✎" onAction="#onOrgEdit" styleClass="prf-iconBtn"/>

                                                <Button fx:id="orgBackBtn" text="← Back" onAction="#onOrgBack"
                                                        styleClass="prf-btn prf-btnSoft prf-miniBtn"
                                                        visible="false" managed="false"/>

                                                <Button fx:id="orgSaveBtn" text="Save" onAction="#onOrgSave"
                                                        styleClass="prf-btn prf-btnPrimary prf-miniBtn"
                                                        visible="false" managed="false"/>
                                            </HBox>

                                            <VBox fx:id="orgViewBox" spacing="10">
                                                <VBox spacing="4">
                                                    <Label text="Organization name" styleClass="prf-label"/>
                                                    <Label fx:id="orgNameView" styleClass="prf-value"/>
                                                </VBox>
                                                <VBox spacing="4">
                                                    <Label text="Website" styleClass="prf-label"/>
                                                    <Label fx:id="websiteView" styleClass="prf-linkValue"/>
                                                </VBox>
                                                <VBox spacing="4">
                                                    <Label text="Description" styleClass="prf-label"/>
                                                    <Label fx:id="orgDescView" styleClass="prf-paragraph" wrapText="true"/>
                                                </VBox>
                                            </VBox>

                                            <VBox fx:id="orgEditBox" spacing="10" visible="false" managed="false">
                                                <VBox spacing="6">
                                                    <Label text="Organization name" styleClass="prf-label"/>
                                                    <TextField fx:id="orgNameField" styleClass="prf-editorField"/>
                                                </VBox>
                                                <VBox spacing="6">
                                                    <Label text="Website" styleClass="prf-label"/>
                                                    <TextField fx:id="websiteField" styleClass="prf-editorField" promptText="https://..."/>
                                                </VBox>
                                                <VBox spacing="6">
                                                    <Label text="Description" styleClass="prf-label"/>
                                                    <TextArea fx:id="orgDescArea" styleClass="prf-editorArea" prefRowCount="4" wrapText="true"/>
                                                </VBox>
                                            </VBox>
                                        </VBox>

                                    </VBox>

                                    <!-- WORKSPACE -->
                                    <VBox styleClass="prf-card" spacing="10">
                                        <Label text="Workspace" styleClass="prf-cardTitle"/>
                                        <Label fx:id="workspaceHintLabel" text="Workspace: coming next." styleClass="prf-muted"/>
                                    </VBox>

                                </VBox>

                                <!-- RIGHT -->
                                <VBox spacing="14" GridPane.columnIndex="1">
                                    <VBox styleClass="prf-card" spacing="10">
                                        <Label text="People you may know" styleClass="prf-cardTitle"/>
                                        <VBox fx:id="peopleBox" spacing="10"/>
                                    </VBox>
                                </VBox>

                            </GridPane>

                        </VBox>
                    </VBox>
                </content>
            </ScrollPane>
        </StackPane>
    </center>
</BorderPane>
