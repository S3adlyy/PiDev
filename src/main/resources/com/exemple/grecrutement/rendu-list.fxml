<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.text.Font?>

<?import javafx.collections.FXCollections?>
<?import java.lang.String?>
<VBox xmlns="http://javafx.com/javafx/17"
      xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="com.exemple.grecrutement.RenduListController"
      spacing="25"
      alignment="TOP_CENTER"
      styleClass="rendu-container"
      style="-fx-background-color: linear-gradient(to bottom right, #f8fafc, #e2e8f0); -fx-padding: 25;">

    <!-- HEADER SECTION -->
    <HBox alignment="CENTER_LEFT" spacing="15">
        <Label text="ðŸ“‘ Submission History"
               styleClass="rendu-title"
               style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #1e293b;"/>

        <HBox spacing="10" HBox.hgrow="ALWAYS" alignment="CENTER_RIGHT">
            <Button text="ðŸ” Filter"
                    styleClass="rendu-filter-btn"
                    onAction="#showFilter"/>
            <Button text="ðŸ“Š Stats"
                    styleClass="rendu-stats-btn"
                    onAction="#showStatistics"/>
        </HBox>
    </HBox>

    <!-- FILTER BAR -->
    <HBox spacing="15" alignment="CENTER_LEFT">
        <Label text="Filter by:" style="-fx-text-fill: #475569; -fx-font-weight: bold;"/>
        <ComboBox fx:id="filterStatus" promptText="All Status" prefWidth="120">
            <items>
                <FXCollections fx:factory="observableArrayList">
                    <String fx:value="All"/>
                    <String fx:value="Accepted"/>
                    <String fx:value="Rejected"/>
                </FXCollections>
            </items>
        </ComboBox>
        <ComboBox fx:id="filterMission" promptText="All Missions" prefWidth="150"/>
        <TextField fx:id="searchField" promptText="Search candidate..." prefWidth="200"/>
        <Button text="Apply" styleClass="rendu-apply-btn" onAction="#applyFilters"/>
        <Button text="Clear" styleClass="rendu-clear-btn" onAction="#clearFilters"/>
    </HBox>

    <!-- STATS SUMMARY -->
    <HBox spacing="30" alignment="CENTER" style="-fx-padding: 0 0 15 0;">
        <VBox alignment="CENTER" spacing="5" style="-fx-padding: 15; -fx-background-color: white; -fx-background-radius: 10; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.08), 10, 0, 0, 2);">
            <Label text="Total Submissions" style="-fx-text-fill: #64748b; -fx-font-size: 12px;"/>
            <Label fx:id="lblTotal" text="0" style="-fx-text-fill: #3b82f6; -fx-font-size: 24px; -fx-font-weight: bold;"/>
        </VBox>
        <VBox alignment="CENTER" spacing="5" style="-fx-padding: 15; -fx-background-color: white; -fx-background-radius: 10; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.08), 10, 0, 0, 2);">
            <Label text="Success Rate" style="-fx-text-fill: #64748b; -fx-font-size: 12px;"/>
            <Label fx:id="lblSuccessRate" text="0%" style="-fx-text-fill: #10b981; -fx-font-size: 24px; -fx-font-weight: bold;"/>
        </VBox>
        <VBox alignment="CENTER" spacing="5" style="-fx-padding: 15; -fx-background-color: white; -fx-background-radius: 10; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.08), 10, 0, 0, 2);">
            <Label text="Avg Score" style="-fx-text-fill: #64748b; -fx-font-size: 12px;"/>
            <Label fx:id="lblAvgScore" text="0%" style="-fx-text-fill: #f59e0b; -fx-font-size: 24px; -fx-font-weight: bold;"/>
        </VBox>
    </HBox>

    <!-- TABLEVIEW -->
    <TableView fx:id="table"
               style="-fx-background-color: transparent; -fx-border-color: #e2e8f0; -fx-border-radius: 10;"
               prefHeight="400">
        <columns>
            <!-- ID Column -->
            <TableColumn fx:id="colId" text="ID"
                         prefWidth="80"
                         style="-fx-alignment: CENTER;">
                <graphic>
                    <Label text="#ï¸âƒ£" style="-fx-font-size: 14px;"/>
                </graphic>
            </TableColumn>

            <!-- Score Column with visual indicator -->
            <TableColumn fx:id="colScore" text="Score"
                         prefWidth="120"
                         style="-fx-alignment: CENTER;">
                <graphic>
                    <Label text="ðŸ“Š" style="-fx-font-size: 14px;"/>
                </graphic>
            </TableColumn>

            <!-- Result Column with status colors -->
            <TableColumn fx:id="colResultat" text="Status"
                         prefWidth="120"
                         style="-fx-alignment: CENTER;">
                <graphic>
                    <Label text="ðŸ·ï¸" style="-fx-font-size: 14px;"/>
                </graphic>
            </TableColumn>

            <!-- Mission Column -->
            <TableColumn fx:id="colMission" text="Mission"
                         prefWidth="200">
                <graphic>
                    <Label text="ðŸŽ¯" style="-fx-font-size: 14px;"/>
                </graphic>
            </TableColumn>

            <!-- Candidate Column -->
            <TableColumn fx:id="colCandidat" text="Candidate"
                         prefWidth="180">
                <graphic>
                    <Label text="ðŸ‘¤" style="-fx-font-size: 14px;"/>
                </graphic>
            </TableColumn>

            <!-- Actions Column -->
            <TableColumn text="Actions"
                         prefWidth="150"
                         style="-fx-alignment: CENTER;">
                <graphic>
                    <Label text="âš™ï¸" style="-fx-font-size: 14px;"/>
                </graphic>
            </TableColumn>
        </columns>

        <!-- Placeholder for empty table -->
        <placeholder>
            <VBox alignment="CENTER" spacing="15" style="-fx-padding: 50;">
                <Label text="ðŸ“­" style="-fx-font-size: 48px;"/>
                <Label text="No submissions yet" style="-fx-text-fill: #94a3b8; -fx-font-size: 16px;"/>
                <Label text="Start by submitting code in the AI Code Submission tab"
                       style="-fx-text-fill: #cbd5e1; -fx-font-size: 12px;"/>
            </VBox>
        </placeholder>
    </TableView>

    <!-- FOOTER CONTROLS -->
    <HBox spacing="15" alignment="CENTER">
        <Button text="ðŸ”„ Refresh Data"
                onAction="#load"
                styleClass="rendu-refresh-btn"
                graphicTextGap="8"/>

        <Button text="ðŸ“¥ Export CSV"
                onAction="#exportToCSV"
                styleClass="rendu-export-btn"
                graphicTextGap="8"/>

        <Button text="ðŸ“‹ View Details"
                onAction="#viewDetails"
                styleClass="rendu-details-btn"
                graphicTextGap="8"/>

        <Button text="ðŸ—‘ï¸ Delete Selected"
                onAction="#deleteSelected"
                styleClass="rendu-delete-btn"
                graphicTextGap="8"/>
    </HBox>

    <!-- PAGINATION (Optional) -->
    <HBox spacing="10" alignment="CENTER">
        <Button text="â®ï¸" styleClass="rendu-pagination-btn"/>
        <Label text="Page" style="-fx-text-fill: #475569;"/>
        <TextField text="1" prefWidth="50" style="-fx-alignment: CENTER;"/>
        <Label text="of 10" style="-fx-text-fill: #475569;"/>
        <Button text="â­ï¸" styleClass="rendu-pagination-btn"/>
    </HBox>
</VBox>